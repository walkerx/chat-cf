# Regex Script 支持测试指南

我们已经成功实现了对 Character Card `regex_scripts` 的支持。这意味着像 "Idol Project X" 这样的卡片现在可以显示丰富的 UI 特效，如弹幕、直播间界面等。

## ✅ 已实现的功能

1. **Regex Script 引擎**：自动读取并应用卡片定义的正则替换规则。
2. **HTML 渲染**：支持渲染 AI 输出的 HTML 内容。
3. **安全性**：使用 `DOMPurify` 严格过滤，防止 XSS 攻击，同时允许安全的自定义标签。
4. **UI 样式**：为常见的自定义标签（`dm`, `zbj`, `nxxf`, `gz`）添加了 CSS 样式。

## 🧪 如何测试

1. **导入卡片**：
   - 导入 `examples/character-cards/【Idol Project X】.json`。

2. **开始聊天**：
   - 进入聊天界面。
   - 发送消息，触发直播间场景（例如："开始直播" 或 "看看观众反应"）。

3. **观察效果**：
   - **弹幕**：应该看到滚动的弹幕文本（`<dm>` 标签）。
   - **直播间**：应该看到带有边框和背景的直播间容器（`<zbj>` 标签）。
   - **公告**：应该看到带有样式的公告文本（`<nxxf>` 标签）。
   - **HTML 内容**：AI 输出的其他 HTML 结构也应该被正确渲染。

## 🔧 调试

如果发现特效没有显示：

1. 检查控制台是否有错误。
2. 确认 AI 是否输出了包含自定义标签的内容（如 `<dm>...</dm>`）。
3. 确认 `regex_scripts` 是否正确加载（可以在 `ChatDisplay.tsx` 中添加日志）。

## 🎨 自定义样式

目前的样式位于 `public/src/styles/chat.css` 的末尾。您可以根据需要调整 `dm`, `zbj`, `nxxf` 等标签的样式。
